# NameDivider API Benchmarks

このディレクトリには、NameDivider API v0.1.0 (latest) と v0.3.0 のパフォーマンス比較を行うためのベンチマークツールが含まれています。

## ディレクトリ構造

```
benchmarks/
├── README.md           # このファイル
├── benchmark.sh        # メインのベンチマークスクリプト
├── test-data/          # テストデータ
│   ├── sample.txt      # サンプルデータ（芥川賞作家名）
│   └── 10000names.txt  # 大規模テストデータ（.gitignore対象）
└── results/            # ベンチマーク結果（.gitignore対象）
```

## 必要な依存関係

- Docker
- jq
- bc

Ubuntu/Debian:
```bash
sudo apt-get install jq bc
```

macOS:
```bash
brew install jq
```

## 使用方法

### 1. テストデータの準備

大規模テスト用に `test-data/10000names.txt` に1行1名前の形式でデータを配置してください：

```
田中太郎
佐藤花子
...
```

### 2. ベンチマーク実行

```bash
cd api/benchmarks
./benchmark.sh
```

### 3. 結果の確認

結果は `results/` ディレクトリに保存されます。

## テスト項目

### パフォーマンステスト
- **単一名前処理**: 1件の名前分割にかかる時間
- **小バッチ処理**: 10件の名前を一括処理
- **中バッチ処理**: 100件の名前を一括処理  
- **大バッチ処理**: 1000件の名前を一括処理

### アルゴリズム比較
- **Basicモード**: デフォルトの漢字特徴量ベースアルゴリズム
- **GBDTモード**: 機械学習ベースアルゴリズム（v0.3.0のみ）

## 測定方法

- 各テストケースは5回実行し、平均値を算出
- レスポンス時間はcurlコマンドで測定
- 1名前あたりの処理時間も計算
- v0.1.0とv0.3.0の改善率を算出

## 期待される結果

v0.3.0では以下の改善が期待されます：

- **単一名前処理**: 約5%の高速化
- **バッチ処理**: 約14%の高速化
- **GBDTモード**: v0.1.0では利用不可、v0.3.0で正常動作

## 注意事項

- ベンチマーク実行中は他のDockerコンテナとのポート衝突に注意
- 大規模データテスト時はメモリ使用量に注意
- ネットワーク状況により結果にばらつきが生じる可能性があります